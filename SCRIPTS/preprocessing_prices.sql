DELETE FROM price_cle
WHERE area NOT IN ('United States of America', 'Ecuador', 'Uruguay', 'Canada', 'Brazil');

DELETE FROM price_cle
WHERE item NOT IN ('Apples','Oats','Spinach','Chickens','Wheat');

DELETE FROM price_cle
WHERE element NOT IN ('Producer Price (USD/tonne)');

UPDATE public.price_cle
SET
    y1991 = COALESCE(y1991, GREATEST(y1992, y1993, y1994, y1995, y1996, y1997, y1998, y1999,
                                     y2000, y2001, y2002, y2003, y2004, y2005, y2006, y2007,
                                     y2008, y2009, y2010, y2011, y2012, y2013, y2014, y2015,
                                     y2016, y2017, y2018, y2019, y2020, y2021, y2022, y2023)),
    y1992 = COALESCE(y1992, GREATEST(y1991, y1993, y1994, y1995, y1996, y1997, y1998, y1999,
                                     y2000, y2001, y2002, y2003, y2004, y2005, y2006, y2007,
                                     y2008, y2009, y2010, y2011, y2012, y2013, y2014, y2015,
                                     y2016, y2017, y2018, y2019, y2020, y2021, y2022, y2023)),
    y1993 = COALESCE(y1993, GREATEST(y1991, y1992, y1994, y1995, y1996, y1997, y1998, y1999,
                                     y2000, y2001, y2002, y2003, y2004, y2005, y2006, y2007,
                                     y2008, y2009, y2010, y2011, y2012, y2013, y2014, y2015,
                                     y2016, y2017, y2018, y2019, y2020, y2021, y2022, y2023)),
    y1994 = COALESCE(y1994, GREATEST(y1991, y1992, y1993, y1995, y1996, y1997, y1998, y1999,
                                     y2000, y2001, y2002, y2003, y2004, y2005, y2006, y2007,
                                     y2008, y2009, y2010, y2011, y2012, y2013, y2014, y2015,
                                     y2016, y2017, y2018, y2019, y2020, y2021, y2022, y2023)),
    y1995 = COALESCE(y1995, GREATEST(y1991, y1992, y1993, y1994, y1996, y1997, y1998, y1999,
                                     y2000, y2001, y2002, y2003, y2004, y2005, y2006, y2007,
                                     y2008, y2009, y2010, y2011, y2012, y2013, y2014, y2015,
                                     y2016, y2017, y2018, y2019, y2020, y2021, y2022, y2023)),
    y1996 = COALESCE(y1996, GREATEST(y1991, y1992, y1993, y1994, y1995, y1997, y1998, y1999,
                                     y2000, y2001, y2002, y2003, y2004, y2005, y2006, y2007,
                                     y2008, y2009, y2010, y2011, y2012, y2013, y2014, y2015,
                                     y2016, y2017, y2018, y2019, y2020, y2021, y2022, y2023)),
    y1997 = COALESCE(y1997, GREATEST(y1991, y1992, y1993, y1994, y1995, y1996, y1998, y1999,
                                     y2000, y2001, y2002, y2003, y2004, y2005, y2006, y2007,
                                     y2008, y2009, y2010, y2011, y2012, y2013, y2014, y2015,
                                     y2016, y2017, y2018, y2019, y2020, y2021, y2022, y2023)),
    y1998 = COALESCE(y1998, GREATEST(y1991, y1992, y1993, y1994, y1995, y1996, y1998, y1999,
                                     y2000, y2001, y2002, y2003, y2004, y2005, y2006, y2007,
                                     y2008, y2009, y2010, y2011, y2012, y2013, y2014, y2015,
                                     y2016, y2017, y2018, y2019, y2020, y2021, y2022, y2023)),
    y1999 = COALESCE(y1999, GREATEST(y1992, y1993, y1994, y1995, y1996, y1997, y1998, y1999,
                                     y2000, y2001, y2002, y2003, y2004, y2005, y2006, y2007,
                                     y2008, y2009, y2010, y2011, y2012, y2013, y2014, y2015,
                                     y2016, y2017, y2018, y2019, y2020, y2021, y2022, y2023)),
    y2000 = COALESCE(y2000, GREATEST(y1992, y1993, y1994, y1995, y1996, y1997, y1998, y1999,
                                     y2000, y2001, y2002, y2003, y2004, y2005, y2006, y2007,
                                     y2008, y2009, y2010, y2011, y2012, y2013, y2014, y2015,
                                     y2016, y2017, y2018, y2019, y2020, y2021, y2022, y2023)),
    y2001 = COALESCE(y2001, GREATEST(y1992, y1993, y1994, y1995, y1996, y1997, y1998, y1999,
                                     y2000, y2001, y2002, y2003, y2004, y2005, y2006, y2007,
                                     y2008, y2009, y2010, y2011, y2012, y2013, y2014, y2015,
                                     y2016, y2017, y2018, y2019, y2020, y2021, y2022, y2023)),
    y2002 = COALESCE(y2002, GREATEST(y1992, y1993, y1994, y1995, y1996, y1997, y1998, y1999,
                                     y2000, y2001, y2002, y2003, y2004, y2005, y2006, y2007,
                                     y2008, y2009, y2010, y2011, y2012, y2013, y2014, y2015,
                                     y2016, y2017, y2018, y2019, y2020, y2021, y2022, y2023)),
    y2003 = COALESCE(y2003, GREATEST(y1992, y1993, y1994, y1995, y1996, y1997, y1998, y1999,
                                     y2000, y2001, y2002, y2003, y2004, y2005, y2006, y2007,
                                     y2008, y2009, y2010, y2011, y2012, y2013, y2014, y2015,
                                     y2016, y2017, y2018, y2019, y2020, y2021, y2022, y2023)),
    y2004 = COALESCE(y2004, GREATEST(y1992, y1993, y1994, y1995, y1996, y1997, y1998, y1999,
                                     y2000, y2001, y2002, y2003, y2004, y2005, y2006, y2007,
                                     y2008, y2009, y2010, y2011, y2012, y2013, y2014, y2015,
                                     y2016, y2017, y2018, y2019, y2020, y2021, y2022, y2023)),
    y2005 = COALESCE(y2005, GREATEST(y1992, y1993, y1994, y1995, y1996, y1997, y1998, y1999,
                                     y2000, y2001, y2002, y2003, y2004, y2005, y2006, y2007,
                                     y2008, y2009, y2010, y2011, y2012, y2013, y2014, y2015,
                                     y2016, y2017, y2018, y2019, y2020, y2021, y2022, y2023)),
    y2006 = COALESCE(y2006, GREATEST(y1992, y1993, y1994, y1995, y1996, y1997, y1998, y1999,
                                     y2000, y2001, y2002, y2003, y2004, y2005, y2006, y2007,
                                     y2008, y2009, y2010, y2011, y2012, y2013, y2014, y2015,
                                     y2016, y2017, y2018, y2019, y2020, y2021, y2022, y2023)),
    y2007 = COALESCE(y2007, GREATEST(y1992, y1993, y1994, y1995, y1996, y1997, y1998, y1999,
                                     y2000, y2001, y2002, y2003, y2004, y2005, y2006, y2007,
                                     y2008, y2009, y2010, y2011, y2012, y2013, y2014, y2015,
                                     y2016, y2017, y2018, y2019, y2020, y2021, y2022, y2023)),
    y2008 = COALESCE(y2008, GREATEST(y1992, y1993, y1994, y1995, y1996, y1997, y1998, y1999,
                                     y2000, y2001, y2002, y2003, y2004, y2005, y2006, y2007,
                                     y2008, y2009, y2010, y2011, y2012, y2013, y2014, y2015,
                                     y2016, y2017, y2018, y2019, y2020, y2021, y2022, y2023)),
    y2009 = COALESCE(y2009, GREATEST(y1992, y1993, y1994, y1995, y1996, y1997, y1998, y1999,
                                     y2000, y2001, y2002, y2003, y2004, y2005, y2006, y2007,
                                     y2008, y2009, y2010, y2011, y2012, y2013, y2014, y2015,
                                     y2016, y2017, y2018, y2019, y2020, y2021, y2022, y2023)),
    y2010 = COALESCE(y2010, GREATEST(y1992, y1993, y1994, y1995, y1996, y1997, y1998, y1999,
                                     y2000, y2001, y2002, y2003, y2004, y2005, y2006, y2007,
                                     y2008, y2009, y2010, y2011, y2012, y2013, y2014, y2015,
                                     y2016, y2017, y2018, y2019, y2020, y2021, y2022, y2023)),
    y2011 = COALESCE(y2011, GREATEST(y1992, y1993, y1994, y1995, y1996, y1997, y1998, y1999,
                                     y2000, y2001, y2002, y2003, y2004, y2005, y2006, y2007,
                                     y2008, y2009, y2010, y2011, y2012, y2013, y2014, y2015,
                                     y2016, y2017, y2018, y2019, y2020, y2021, y2022, y2023)),
    y2012 = COALESCE(y2012, GREATEST(y1992, y1993, y1994, y1995, y1996, y1997, y1998, y1999,
                                     y2000, y2001, y2002, y2003, y2004, y2005, y2006, y2007,
                                     y2008, y2009, y2010, y2011, y2012, y2013, y2014, y2015,
                                     y2016, y2017, y2018, y2019, y2020, y2021, y2022, y2023)),
    y2013 = COALESCE(y2013, GREATEST(y1992, y1993, y1994, y1995, y1996, y1997, y1998, y1999,
                                     y2000, y2001, y2002, y2003, y2004, y2005, y2006, y2007,
                                     y2008, y2009, y2010, y2011, y2012, y2013, y2014, y2015,
                                     y2016, y2017, y2018, y2019, y2020, y2021, y2022, y2023)),
    y2014 = COALESCE(y2014, GREATEST(y1992, y1993, y1994, y1995, y1996, y1997, y1998, y1999,
                                     y2000, y2001, y2002, y2003, y2004, y2005, y2006, y2007,
                                     y2008, y2009, y2010, y2011, y2012, y2013, y2014, y2015,
                                     y2016, y2017, y2018, y2019, y2020, y2021, y2022, y2023)),
    y2015 = COALESCE(y2015, GREATEST(y1992, y1993, y1994, y1995, y1996, y1997, y1998, y1999,
                                     y2000, y2001, y2002, y2003, y2004, y2005, y2006, y2007,
                                     y2008, y2009, y2010, y2011, y2012, y2013, y2014, y2015,
                                     y2016, y2017, y2018, y2019, y2020, y2021, y2022, y2023)),
    y2016 = COALESCE(y2016, GREATEST(y1992, y1993, y1994, y1995, y1996, y1997, y1998, y1999,
                                     y2000, y2001, y2002, y2003, y2004, y2005, y2006, y2007,
                                     y2008, y2009, y2010, y2011, y2012, y2013, y2014, y2015,
                                     y2016, y2017, y2018, y2019, y2020, y2021, y2022, y2023)),
    y2017 = COALESCE(y2017, GREATEST(y1992, y1993, y1994, y1995, y1996, y1997, y1998, y1999,
                                     y2000, y2001, y2002, y2003, y2004, y2005, y2006, y2007,
                                     y2008, y2009, y2010, y2011, y2012, y2013, y2014, y2015,
                                     y2016, y2017, y2018, y2019, y2020, y2021, y2022, y2023)),
    y2018 = COALESCE(y2018, GREATEST(y1992, y1993, y1994, y1995, y1996, y1997, y1998, y1999,
                                     y2000, y2001, y2002, y2003, y2004, y2005, y2006, y2007,
                                     y2008, y2009, y2010, y2011, y2012, y2013, y2014, y2015,
                                     y2016, y2017, y2018, y2019, y2020, y2021, y2022, y2023)),
    y2019 = COALESCE(y2019, GREATEST(y1992, y1993, y1994, y1995, y1996, y1997, y1998, y1999,
                                     y2000, y2001, y2002, y2003, y2004, y2005, y2006, y2007,
                                     y2008, y2009, y2010, y2011, y2012, y2013, y2014, y2015,
                                     y2016, y2017, y2018, y2019, y2020, y2021, y2022, y2023)),
    y2020 = COALESCE(y2020, GREATEST(y1992, y1993, y1994, y1995, y1996, y1997, y1998, y1999,
                                     y2000, y2001, y2002, y2003, y2004, y2005, y2006, y2007,
                                     y2008, y2009, y2010, y2011, y2012, y2013, y2014, y2015,
                                     y2016, y2017, y2018, y2019, y2020, y2021, y2022, y2023)),
    y2021 = COALESCE(y2021, GREATEST(y1992, y1993, y1994, y1995, y1996, y1997, y1998, y1999,
                                     y2000, y2001, y2002, y2003, y2004, y2005, y2006, y2007,
                                     y2008, y2009, y2010, y2011, y2012, y2013, y2014, y2015,
                                     y2016, y2017, y2018, y2019, y2020, y2021, y2022, y2023)),
    y2022 = COALESCE(y2022, GREATEST(y1992, y1993, y1994, y1995, y1996, y1997, y1998, y1999,
                                     y2000, y2001, y2002, y2003, y2004, y2005, y2006, y2007,
                                     y2008, y2009, y2010, y2011, y2012, y2013, y2014, y2015,
                                     y2016, y2017, y2018, y2019, y2020, y2021, y2022, y2023)),
    y2023 = COALESCE(y2023, GREATEST(y1991, y1992, y1993, y1994, y1995, y1996, y1997, y1998, y1999,
                                     y2000, y2001, y2002, y2003, y2004, y2005, y2006, y2007,
                                     y2008, y2009, y2010, y2011, y2012, y2013, y2014, y2015,
                                     y2016, y2017, y2018, y2019, y2020, y2021, y2022))
WHERE
    y1991 IS NULL OR y1992 IS NULL OR y1993 IS NULL OR y1994 IS NULL OR y1995 IS NULL OR y1996 IS NULL OR
y1997 IS NULL OR y1998 IS NULL OR y1999 IS NULL OR y2000 IS NULL OR y2001 IS NULL OR y2002 IS NULL OR
y2003 IS NULL OR y2004 IS NULL OR y2005 IS NULL OR y2006 IS NULL OR y2007 IS NULL OR y2008 IS NULL OR
y2009 IS NULL OR y2010 IS NULL OR y2011 IS NULL OR y2012 IS NULL OR y2013 IS NULL OR y2014 IS NULL OR
y2015 IS NULL OR y2016 IS NULL OR y2017 IS NULL OR y2018 IS NULL OR y2019 IS NULL OR y2020 IS NULL OR
y2021 IS NULL OR y2022 IS NULL OR y2023 IS NULL
;